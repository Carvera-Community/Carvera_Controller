
<ProbingPopup>:
    title:"Probing"
    size_hint: 0.618, 0.6
    pos_hint: {"center_x": 0.5, "center_y": 0.5}
    auto_dismiss: False
#    cb_probe_normally_open: cb_probe_normally_open
#    cb_probe_normally_closed: cb_probe_normally_closed
#    probe_preview_label: probe_preview_label
#    txt_x: txt_x
#    txt_y: txt_y
#    txt_z: txt_z
#    txt_a: txt_a
    GridLayout:
        cols:1
        rows:2
        spacing: dp(10)
        padding: dp(3)
        GridLayout:
            cols:2
            rows:1
            spacing: dp(10)
            padding: dp(3)

            TabbedPanel:
                size_hint_min_x: (root.width * .65)
                do_default_tab: False
                tab_width: dp(111)

                TabbedPanelItem:
                    text: tr._('Single Axis')
                    GridLayout:
                        cols: 3
                        rows: 3
                        spacing: dp(8)
                        padding: 10

                        Label:
                            size: dp(100), dp(100)
                            size_hint: None, None

                        ProbeButton:
                            on_press: root.on_probing_pressed("y-minus")
                            image:'addons/probing/data/icons_1024x768/Y-.png'

                        Label:
                            size: dp(100), dp(100)
                            size_hint: None, None

                        ProbeButton:
                            on_press: root.on_probing_pressed("x-plus")
                            image: 'addons/probing/data/icons_1024x768/X+.png'

                        ProbeButton:
                            on_press: root.on_probing_pressed("probe_z")
                            image: 'addons/probing/data/icons_1024x768/probe_z.png'

                        ProbeButton:
                            on_press: root.on_probing_pressed("x-minus")
                            image: 'addons/probing/data/icons_1024x768/X-.png'

                        Label:
                            size: dp(100), dp(100)
                            size_hint: None, None

                        ProbeButton:
                            on_press: root.on_probing_pressed("y-plus")
                            image: 'addons/probing/data/icons_1024x768/Y+.png'

                        Label:
                            size: dp(100), dp(100)
                            size_hint: None, None

                TabbedPanelItem:
                    text: tr._('Corners')
                    GridLayout:
                        cols:2
                        rows:1
                        spacing:dp(10)
                        padding:dp(10)

                        GridLayout:
                            cols: 2
                            rows: 2
                            spacing: dp(8)
                            padding: 10

                            ProbeButton:
                                on_press: root.on_probing_pressed("inside-corner-x-plus-y-minus")
                                image: 'addons/probing/data/icons_1024x768/inX+Y-.png'

                            ProbeButton:
                                on_press: root.on_probing_pressed("inside-corner-x-minus-y-minus")
                                image: 'addons/probing/data/icons_1024x768/inX-Y-.png'

                            ProbeButton:
                                on_press: root.on_probing_pressed("inside-corner-x-plus-y-plus")
                                image: 'addons/probing/data/icons_1024x768/inX+Y+.png'

                            ProbeButton:
                                on_press: root.on_probing_pressed("inside-corner-x-minus-y-plus")
                                image: 'addons/probing/data/icons_1024x768/inX-Y+.png'

                        GridLayout:
                            cols: 2
                            rows: 2
                            spacing: dp(8)
                            padding: 10

                            ProbeButton:
                                on_press: root.on_probing_pressed("outside-corner-x-plus-y-minus")
                                image: 'addons/probing/data/icons_1024x768/X+Y-.png'
                            ProbeButton:
                                on_press: root.on_probing_pressed("outside-corner-x-minus-y-minus")
                                image: 'addons/probing/data/icons_1024x768/X-Y-.png'

                            ProbeButton:
                                on_press: root.on_probing_pressed("outside-corner-x-plus-y-plus")
                                image: 'addons/probing/data/icons_1024x768/X+Y+.png'

                            ProbeButton:
                                on_press: root.on_probing_pressed("outside-corner-x-minus-y-plus")
                                image: 'addons/probing/data/icons_1024x768/X-Y+.png'

                TabbedPanelItem
                    text: tr._('Bore/Boss')
                    GridLayout:
                        cols: 3
                        rows: 3
                        spacing: dp(8)
                        padding: 10

                        ProbeButton:
                            on_press: root.on_probing_pressed("boss-circle-center")
                            image: 'addons/probing/data/icons_1024x768/xy_center.png'

                        ProbeButton:
                            on_press: root.on_probing_pressed("inside-hole")
                            image: 'addons/probing/data/icons_1024x768/inHole.png'

                TabbedPanelItem:
                    text: tr._('Misc')
                    GridLayout:
                        cols: 3
                        rows: 10
                        spacing: dp(8)
                        padding: 0



            # Note: i only did a tabbed panel here since I dont want to spend
            # the time to figure out making a title header :grimace:
            TabbedPanel:
                size_hint_min_x: (root.width * .3) + dp(10)
                do_default_tab: False
                tab_width: self.width
                TabbedPanelItem:
                    text: tr._('Settings')
                    GridLayout:
                        cols:1
                        rows:10
                        spacing:dp(3)
                        padding:dp(1)

                        ProbeSettingLabel:
                            label_text: 'Tip Dia:'
                            hint_text: 'tip diameter'

                        ProbeSettingLabel:
                            label_text: 'Slow Feed Rate:'
                            hint_text: 'Slow Feed Rate'

                        ProbeSettingLabel:
                            label_text: 'Fast Feed:'
                            hint_text: 'Fast feed rate'

                        ProbeSettingLabel:
                            label_text: 'Max Distance:'
                            hint_text: 'Max Probing distance'
                            visible:False

        BoxLayout:
            spacing: '5dp'
            size_hint_y: None
            height: '40dp'
            Button:
                id: btn_close
                text: tr._('Close')
                on_release: root.dismiss()

<ProbeButton@Button>:
    background_color: 0,0,0,0  # the last zero is the critical on, make invisible
    size: dp(100), dp(100)
    size_hint: None, None
    image: ''
    canvas.before:
        Color:
            rgba: (88/255,88/255,88/255,1) if self.state=='normal' else (50/255,164/255,206/255,1)  # visual feedback of press
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(3),]
    Image:
        source: root.image
        size: root.size
        size_hint: None, None
        center_x: self.parent.center_x
        center_y: self.parent.center_y

<ProbeSettingLabel@GridLayout>:
    cols:2
    rows:1
    spacing: dp(3)
    padding: dp(3)
    size_hint_max_x: dp(300)
    size_hint_max_y: dp(33)
    label_text:''
    hint_text:''

    Label:
        text: root.label_text
        size_hint_min_x: dp(75)
        halign: 'right'
        valign: 'middle'
        text_size: self.size

    TextInput:
        hint_text: root.hint_text
        multiline: False
        halign:'left'
        input_type: 'number'
        input_filter: 'float'